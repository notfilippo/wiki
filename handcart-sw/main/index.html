
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.6">
    
    
      
        <title>Handcart Documentation - Eagle TRT</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.a57b2b03.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#handcart-documentation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Eagle TRT" class="md-header__button md-logo" aria-label="Eagle TRT" data-md-component="logo">
      
  <img src="../../static/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Eagle TRT
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Handcart Documentation
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Eagle TRT" class="md-nav__button md-logo" aria-label="Eagle TRT" data-md-component="logo">
      
  <img src="../../static/logo.png" alt="logo">

    </a>
    Eagle TRT
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        E-Agle TRT Wiki
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          DAS ECU hw
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="DAS ECU hw" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          DAS ECU hw
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../DAS_ECU_hw/DAS_ECU/" class="md-nav__link">
        DAS+ECU
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Common
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Common" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Common
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1" type="checkbox" id="__nav_3_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1">
          About
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="About" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          About
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../common/about/writing-docs/" class="md-nav__link">
        Writing Documentation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_2">
          Shared
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Shared" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Shared
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../common/shared/can-debugging/" class="md-nav__link">
        CAN-bus Troubleshooting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../common/shared/openocd-errors/" class="md-nav__link">
        OpenOCD errors
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Fenice bms hv sw
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Fenice bms hv sw" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Fenice bms hv sw
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../fenice-bms-hv-sw/" class="md-nav__link">
        High-Voltage Battery Management System
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_2">
          Mainboard
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Mainboard" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Mainboard
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../fenice-bms-hv-sw/mainboard/" class="md-nav__link">
        Mainboard
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../fenice-bms-hv-sw/mainboard/io/" class="md-nav__link">
        I/O
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2_3" type="checkbox" id="__nav_4_2_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_2_3">
          Subsystems
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Subsystems" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_2_3">
          <span class="md-nav__icon md-icon"></span>
          Subsystems
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../fenice-bms-hv-sw/mainboard/subsystems/bal/" class="md-nav__link">
        Cell Balancing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../fenice-bms-hv-sw/mainboard/subsystems/bms_cli/" class="md-nav__link">
        Command Line Interface
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../fenice-bms-hv-sw/mainboard/subsystems/bms_fsm/" class="md-nav__link">
        Main State Machine
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../fenice-bms-hv-sw/mainboard/subsystems/config/" class="md-nav__link">
        Config
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          ECU
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="ECU" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          ECU
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../fenice-ecu/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../fenice-ecu/modules/" class="md-nav__link">
        Modules
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../fenice-ecu/fsm/" class="md-nav__link">
        Finite State Machine
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Steering Wheel
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Steering Wheel" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Steering Wheel
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../fenice-steeringwheel/" class="md-nav__link">
        Steering Wheel
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_2" type="checkbox" id="__nav_6_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6_2">
          Development
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Development" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_2">
          <span class="md-nav__icon md-icon"></span>
          Development
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../fenice-steeringwheel/development/qt/" class="md-nav__link">
        Building Qt for the Raspberry Pi
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_3" type="checkbox" id="__nav_6_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6_3">
          Interface
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Interface" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_3">
          <span class="md-nav__icon md-icon"></span>
          Interface
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../fenice-steeringwheel/interface/tabs/" class="md-nav__link">
        Concept of Tabs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Handcart hw
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Handcart hw" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Handcart hw
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../handcart-hw/handcart/" class="md-nav__link">
        Handcart / Charger
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Handcart Documentation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Handcart Documentation" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Handcart Documentation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Handcart Documentation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Handcart Documentation
      </a>
      
        


<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#index" class="md-nav__link">
    Index
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#intro" class="md-nav__link">
    Intro
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abbreviations" class="md-nav__link">
    Abbreviations
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#index" class="md-nav__link">
    Index
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#intro" class="md-nav__link">
    Intro
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abbreviations" class="md-nav__link">
    Abbreviations
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="handcart-documentation">Handcart Documentation</h1>
<h2 id="index">Index</h2>
<ul>
<li><a href="#structure">Structure</a></li>
<li><a href="#resources">Resources &amp; Useful links</a></li>
</ul>
<h2 id="intro">Intro</h2>
<p>The handcart is the device that is responsible of transporting and charging the car's accumulator. It is based on three main components:</p>
<ul>
<li>Brusa NLG513 charger, that is the actual charger</li>
<li>Raspberry pi 4 to run the software</li>
<li>High Voltage Accumulator</li>
</ul>
<p>The rasp is connected via CAN Bus with the BMS in the accumulator and with the Brusa charger. The software of the handcart is responsible of all the processes to ensure a good and safe charge.</p>
<h2 id="abbreviations">Abbreviations</h2>
<ul>
<li>BMS, porco, acc -&gt; accumulator</li>
<li>HV -&gt; High Voltage</li>
<li>rasp -&gt; raspberry</li>
<li>FSM -&gt; Finite State Machine</li>
<li>TS (on, off) -&gt; Tractive system (HV) (on o off)</li>
</ul>
<h1 id="software">Software</h1>
<h2 id="overview">Overview</h2>
<p><img alt="General diagram" src="https://lucid.app/publicSegments/view/04f173a9-55f8-42e4-9aa7-747b02ec5147/image.jpeg" /></p>
<p>The software is written in python and javascript. It's divided in two parts, respectively frontend and backend. The backend is responsible to manage the charge and to communicate with the devices, and it also hosts a webserver for the frontend.</p>
<h2 id="backend">Backend</h2>
<p>The backend is the part of the software that is responsible to manage the charge and to communicate with the devices, it also hosts a webserver to serve pages and data to the frontend.
Basically it is a python script that becomes a process, then it splits itself in three threads.</p>
<h3 id="threads">Threads</h3>
<p>The three threads are:</p>
<ul>
<li>The state machine, aka the main thread</li>
<li>The flask webserver</li>
<li>The CAN read/write process</li>
</ul>
<p>The three threads have an class istance that they can access which is in shared memory, accessed with a lock.
Other types of communication are two queues:</p>
<ul>
<li>A queue for can msg send between FSM thread and CAN thread</li>
<li>A queue for can msg recv between FSM thread and CAN thread</li>
<li>A queue for command send between web server and the FSM</li>
</ul>
<h3 id="main-thread-with-fsm">Main thread with FSM</h3>
<p>The FSM is based on multiple states:</p>
<ul>
<li>CHECK: It is a state where the presence of the BMS and the BRUSA are checked, if they are both present it will pass to next state</li>
<li>IDLE: Both devices are connected and ready to rock, a precharge command is waited</li>
<li>PRECHARGE: Accumulator is asked TS ON, wait until a confirmation is received</li>
<li>READY: Accumulator is in TS ON, brusa is ready, waiting for a charge command</li>
<li>CHARGE: The charge is enabled</li>
<li>C_DONE: The charge is finished</li>
<li>ERROR: An error state, the charge (if enabled) is stopped, the BMS is asked to TS OFF, the PON of brusa is set to OFF</li>
</ul>
<p>Note that in each state there's a check over errors from the can, if an error is found, the next state will be ERROR</p>
<h4 id="statecheck">STATE:CHECK</h4>
<p>The presence of BMS and BRUSA is checked, if both are present, goto IDLE</p>
<h4 id="stateidle">STATE:IDLE</h4>
<p>Both devices are connected and ready to rock, a precharge command is waited.</p>
<h4 id="stateprecharge">STATE:PRECHARGE</h4>
<p>A TS ON can message is sent to BMS HV, which will do the precharge. In this state we will check if the bms will finish the precharge. Once it did so, the FSM willl go to READY state.</p>
<h4 id="stateready">STATE:READY</h4>
<p>The TS is on, we are waiting to receive the charge command from the webserver. We countinously check the queue for new messages.</p>
<h4 id="statecharge">STATE:CHARGE</h4>
<p>In this state the charge is enabled, to do this, a variable named "can_forward_enabled" is set to True. This variable is shared between the FSM trhead and the CAN thread.
In the can thread, a check over can_forward_enabled is made, if it's False it will periodically send an empty CAN message to brusa (this is important to keep the link alive, otherwise the brusa will go in an error state if no msgs receivedin 300ms)
If it's True, it will send an enable charge command to brusa with the voltage and current settings. For more info check the brusa CAN messages matrix.</p>
<h4 id="statec_done">STATE:C_DONE</h4>
<p>The charge is done, TS is still on, waiting for user input.</p>
<h4 id="stateerror">STATE:ERROR</h4>
<p>Something triggered an error, we have to turn off everithing that could be dangerous. The method "staccastacca()" is called. Where a TS_OFF message both for chimera's and fenice's accumulator is sent. The message is sent until a confirmation about the fact that the TS is OFF is received.
In the staccastacca method also the PON is disabled</p>
<h4 id="the-canread-object">The canread object</h4>
<p>The 'canread' object is an istance of a class that is thought to store all the information of the BMS, BRUSA, CAN and others. It is also used to process all the CAN messages. The CAN thread passes the can messages in the CAN queue and the FSM thread checks for new messages in the queue at each cycle, if so the message is processed in the canread object using a method. The canread object is accessed only by the thread of the FSM, the other threads access a copy of that object that is called shared_data.
This is done for safety reason and to assure a fast access without lag to the main thread, as this object contains error state variables.</p>
<h3 id="flask-http-server">Flask HTTP server</h3>
<p>This is the server that serve the requests received from the frontend. It uses the shared_data object to retrieve the data from the FSM thread</p>
<h2 id="frontend">Frontend</h2>
<p>The handcart's frontend is a webapp based on javascript and html, it fetches the data from the backend by doing RESTFUL requests to the backend.
Chart are created using amcharts 4 (https://www.amcharts.com/) with Javascript method (NOT the JSON method).
To use fetches there are some basic method such as the request-create and the POST method to submit data.
I strongly recommend you to use the "formListener" method that take a form and the partial URL (because we have to send commands only on the "/command/" path, so we can avoid things that can't be done)
In forms I create some hidden parameters to identify the command we want to send and it have to correspond with the json parameters shown in the documentation describing the json format.</p>
<h3 id="includeheaderhtml">include/header.html</h3>
<p>Is the top-bar that have all status, number of warnings and errors, and actual value for each parameter needed.
The error and warning's counter can be clicked to access the respective pages.
Every value in the header are calculated by the js/status.js file, which will be loaded on page loading.
There's also a big SHUTDOWN button to turn off the charge every time, independently whether page you are.</p>
<h3 id="indexhtml">index.html</h3>
<p>This page has six charts: the first on top-left graphically describe the latest voltage values, then you have the charge percentage and the latest current values on the first row.
On the second row there are the latest temperature's chart and two charts about cells voltage and temperature that will work only with Fenice (Chimera still don't have these values).<br>
Data are received by the flask server using a fetch for each chart to fill the previous data (30 zeros to avoid graphical issues) and then another fetch will be called to ask the server the last data, in order to have a live chart (every 2 seconds).</p>
<h3 id="errorhtml-and-warninghtml">error.html and warning.html</h3>
<p>These two pages just print BMS-HV and Brusa errors and warnings in a table.
The creating-table method is inside the js/tables.js file and look at the json's parameters to create the table.
If you need to print a json with the "title-parameter" in one column instead of on a row, follow the method used in brusa-info.html.</p>
<h3 id="brusa-infohtml">brusa-info.html</h3>
<p>In this page are displayed some Brusa's flags in a table made as described above.</p>
<h3 id="settingshtml">settings.html</h3>
<p>Here you can modify some parameters, for example the Cut-Off voltage, the maximum current outlet and a button to enable or disable the fastcharge.</p>
<h3 id="charthtml">chart.html</h3>
<p>This page can actually display "more pages": it depends on the parameter passed using the GET method.
This parameter is used to set a title in the page and to decide which chart you want to display.
At this point it will automatically check which chart-function it has to call and calls also the functions to update the header's values.
Those charts won't refresh automatically: you have to refresh the page to see all new data, so you can use the zoom (by clicking in the start position and drag until the end position of the zoom).
To seeing all values about a specific chart there is a function called "createMultilineChart" that will create a chart with many lines as parameters that are in the json (timestamp excluded). </p>
<h3 id="chart-functions">Chart functions</h3>
<p>In addition to chart's creating functions there are some utilities functions in "/chart/chartsFun.js": most of them are
in this file just to clear the main one and to reuse them if needed, however they contain the more logical part
(i.e. how to set the correct color using a percentage or how to set the correct position of each cell value according to the real position - check the image below to understand it better).</p>
<p><img alt="Cell position in the car" src="https://lucid.app/publicSegments/view/0d31d787-d408-4bd9-9a63-ce9854e574ae/image.png" /></p>
<h2 id="raspberry-configuration">Raspberry configuration</h2>
<p>Follow the guide
here <a href="https://github.com/eagletrt/chimera-steeringwheel/blob/1402786b2e5fb6a07b8e8e68f7986f989c5b448c/tools/README.MD">Rasp config</a>
. The password of the raspberry is "handcartpi". In the handcart just one CAN bus is necessary.</p>
<h1 id="hardware">Hardware</h1>
<h2 id="electrical-wiring">Electrical wiring</h2>
<h3 id="modular-cables-for-accumulator-connection">Modular cables for Accumulator connection</h3>
<p>I decided to create two modular cables that have a common connector handcart-side, but different connectors at accumulator-side, in a way that we are able to easily switch the connectors between the two accumulators.
Both cables connect to the handcart via an Amphenol AT06-12SX1 connector, having these pin mapping:</p>
<ul>
<li>1 - 12V Supply</li>
<li>2 - 5V Supply (only chimera)</li>
<li>3 - CAN H</li>
<li>4 - TSMS</li>
<li>5 - RESET</li>
<li>6 - IMD LED</li>
<li>7 - Cockpit LED</li>
<li>8 - BMS LED</li>
<li>9 - TO TSMS</li>
<li>10 - CAN L</li>
<li>11 - SD</li>
<li>12 - GND</li>
</ul>
<h4 id="chimera-evoluzione-accumulator-cable">Chimera Evoluzione accumulator cable</h4>
<p>To the other side of the cable we have two connectors, LV-CAN and SD IMD BMS. They use the same connectors used for chimera’s CAN.
LV-CAN pin mapping:</p>
<ul>
<li>1 - RESET</li>
<li>2 - BMS LED</li>
<li>3 - empty</li>
<li>4 - TO TSMS</li>
<li>5 - SD</li>
<li>6 - empty</li>
<li>7 - IMD</li>
<li>8 - TSMS</li>
</ul>
<p>SD IMD BMS pin mapping:</p>
<ul>
<li>As chimera can connectors standard</li>
</ul>
<h4 id="fenice-accumulator-cable">Fenice accumulator cable</h4>
<p>As for chimera it has two connectors to the other end of the cable, this time, the connectors are TE 776273-1 for SD IMD BMS and CeeLok FAS-T for LV CAN.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
</div>
<p>Tip for the CeeLok FAS-T connector: if you ever want to build this connector, unless you have the dedicated crimper (M22520/2-01) (685€) (which you can ask to proM), do not attempt to crimp the pins (3€ each), my advice is to solder the cable inside, it is much more resistant than a bad crimp, which is what you’ll get if you take a piler and start squeezing the pin :)</p>
<p>LV CAN pinout:</p>
<ul>
<li>1 - 12V Supply</li>
<li>2 - Empty</li>
<li>3 - GND</li>
<li>4 - empty</li>
<li>5 - CAN H</li>
<li>6 - CAN L</li>
<li>7 - empty</li>
<li>8 - empty</li>
</ul>
<p>The other connector is much easier to work with.
SD IMD BMS pinout:</p>
<ul>
<li>6 - from TSMS</li>
<li>7 - to TSMS</li>
<li>8 - BMS LED</li>
<li>9 - IMD LED</li>
<li>10 - COCKPIT LED</li>
<li>11 - FROM SD</li>
<li>12 - RESET</li>
</ul>
<p>The mapping between the Amphenol connector and the others is self-explanatory,I’m not going to talk about it.</p>
<h2 id="the-shutdown-circuit">The shutdown circuit</h2>
<p>The shutdown circuit is generated from the PSU, then it passes through the mushroom, to a relay which is controlled by the rasp, then TO_CHARGER, which is the interlock of the connector of the brusa, and then FROM_CHARGER to BMS’s SD, then out of the BMS, to the TSMS key, then in to the BMS again to the airs.
Note that the PON (Power ON) of the BRUSA is powered from the shutdown circuit, this way, if the shutdown is opened, the BRUSA is instantaneously disabled.</p>
<h2 id="handcart-pcb">Handcart PCB</h2>
<h1 id="brusa-nlg5-charger-deep-dive">BRUSA NLG5 Charger deep dive</h1>
<p>The brusa can be controlled using CAN or can be programmed to be used without the CAN.
For our purposes we will control it over CAN BUS.</p>
<h2 id="serial-connection">Serial connection</h2>
<p>To connect with brusa both for debug and/or change the settings we can use the serial interface.
To do so, you have to have an USB to serial adapter, connected to the pins of the BRUSA's connector, check the brusa manual. There are specific settings to set up the serial connection, in german they're called anschlusseinstellungen:</p>
<ul>
<li>Baudrate: 19200</li>
<li>Data bits: 8</li>
<li>parity: none</li>
<li>stopbits: 1</li>
<li>protocol: Xon/Xoff</li>
</ul>
<p>If you are on windows, let the serial COM settings as default, but edit the putty settings, i got
some problems otherwise.
Very important : i don't know why, but if you are going to use ChargeStar software you need
to change the COM port to COM1, otherwise the brusa will not be recognized by the program.
Note that the serial works only if the board on the brusa is fed with 12 volts via the proper pin
2 AUX or with the main power.</p>
<p>to use the serial monitor you have to properly connect and setup the serial, then, use putty on
windows or minicom on linux to connect to it. You will asked with a pasword, which is "monitor"</p>
<h2 id="chargestar-software">ChargeStar software</h2>
<p>With the ChargeStar software you can program a charging profile, set various parameters and
change some configuration of the brusa, see the brusa's manual for all the infos. Via ChargeStar
you can also set the mode to CAN, very useful to control the charge via can. The ChargeStar
software will run only on Windows XP or Windows Vista, obviously we'll chose XP, you can
run a virtual machine on virtualbox and do the USB-passthrough of the serial to USB adapter.
I read that somebody had issues with ChargeStar using the 64 bit version of windows, but for
me worked fine. Note that i ran in some problems uploading a custom setting to the brusa:
sometimes when the settings are uploaded, the brusa gives an NVSRAM CRC error, the only
possible fix is reupload the settings to brusa changing some parameters a bit. I'm still not sure which parameter is causing problems, so change them randomly a bit and it should work after some
tries. If you see, some input fields don't accept values with the "." not sure why.</p>
<h2 id="connecting-by-can">Connecting by CAN</h2>
<p>Connecting with CAN allows to monitor the message outputed by the brusa and (if properly
configured) to set some parameters for charging. The CAN connection has to end with a 120
Ohm resistor, otherwise the messages will keep bouncing (kinda), trust me, it is necessary.
See the full CAN matrix in the manual.
By default the CAN is at 500kbps, unless differently specified in config file with ChargeStar. As
i saw, brusa send messages just when the PON pin is set to HIGH (&gt;5V). To set and enable the
charge via can you have to send periodically a can message named NLG5_CTL see details on
the can matrix.
Note that the endianess is big (motorola).</p>
<h1 id="setup-procedure">Setup procedure</h1>
<p>First, you need to know what you’re doing, you’re going to work with High Voltage both AC and DC, that’s no joke.</p>
<h2 id="finding-a-good-power-source">Finding a good power source</h2>
<p>Brusa will be absorbing a maximum of 16A on a 230V AC 50Hz outlet, so a maximum of 3.6kW, if you’re using the tripolar connector there shouldn’t be any problem, otherwise if you’re using the tripolar to standard socket adaptor, make sure to check if the line is properly supporting the load. Usually it would just warm up the cables, but if you’re unlucky this could cause a fire, so BE CAREFUL. Note that it is possible to specify to the BRUSA how buc current to absorb.</p>
<h2 id="connecting-the-accumulator">Connecting the accumulator</h2>
<p>Depending on the accumulator (Chimera or Fenice) you have to choose the right cable.
Turn off the TSMS key
Turn off the PON switch
Connect the accumulator and the brusa with the HV connector. With chimera make sure that it makes a good contact, sometimes the interlock will not be closed properly.
Connect the two LV connectors to the accumulator, and the other end to the handcart.</p>
<h2 id="connecting-brusa-to-220">Connecting brusa to 220</h2>
<p>Once a good power source has been found, connect the brusa to it. You’ll hear a “click” from the BRUSA.</p>
<h1 id="charge-procedure">Charge procedure</h1>
<p>Make sure that just the people needed are near the handcart, the presence of an ESO would be ideal in a not official environment, and required in a race environment.
Turn ONthe TSMS key. From now on, the system could be at &gt;400 DC volt.
Turn ON the PON.
Start the charging software, and then, start the charge.
In case of any problem, push the red shutdown button in the handcart, this will stop the charge and close the AIRs of the accumulator.</p>
<h1 id="backup-emergency-software">Backup (Emergency) software</h1>
<p>Before starting, follow the set up procedure for the handcart.
It is necessary to initialize the canbus on the raspberry pi, just execute <a href="https://github.com/eagletrt/handcart/blob/master/utils/start-can.sh">this</a> script.
If you need the handcart working as fast as possible, just download the <a href="https://github.com/eagletrt/handcart/blob/master/utils/charge_script.py">charge script</a> from github, and execute it on the raspberry pi, you will be guided through the precharge process of the accumulator and the charge settings.</p>
<p>!!! Warning : This software is DUMB, if you set a voltage, the brusa will deliver it, be careful!.
!!! Warning: at the time of writing (18/09/2021) the script supports just chimera’s accumulator, this can be bypassed by reading the next note.
!!! Tip: if you need to bypass the precharge check of the accumulator for any reason, you can set the variable “BYPASS_TS_CHECK” in the script to false, this way the script will not check the presence of the accumulator, and the brusa will work on anything it is attached to.</p>
<h1 id="resources-useful-links">Resources &amp; Useful links</h1>
<ul>
<li><a href="https://www.brusa.biz/_files/drive/02_Energy/Chargers/NLG5/NLG5_BRUSA.html">here</a> you can find BRUSA's CAN messages</li>
<li>For pork's can messages search on other E-Agle's repo</li>
<li><a href="https://realpython.com/pointers-in-python/#simulating-pointers-in-python">Fake pointers in python</a></li>
<li><a href="https://docs.python.org/3/library/threading.html">Python threading API</a></li>
<li><a href="https://getbootstrap.com/docs/4.5/examples/dashboard/">Bootstrap dashboard template</a></li>
<li><a href="https://www.amcharts.com">JS Charts</a></li>
<li><a href="https://github.com/eagletrt/chimera-steeringwheel/blob/1402786b2e5fb6a07b8e8e68f7986f989c5b448c/tools/README.MD">Rasp config</a></li>
<li><a href="https://github.com/eagletrt/chimera-bms/blob/sw-charging/src/Src/chg.c">Charge state machine of BMS</a></li>
</ul>
<h2 id="diagram-links">Diagram links</h2>
<p>https://lucid.app/lucidchart/invitations/accept/dbc53a3d-c901-4d6a-a692-972de6713d43
https://www.raspberrypi.org/documentation/hardware/raspberrypi/spi/README.md</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../../handcart-hw/handcart/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Handcart / Charger" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Handcart / Charger
            </div>
          </div>
        </a>
      
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; E-Agle TRT
          </div>
        
        
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/eagletrt" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M336.5 160C322 70.7 287.8 8 248 8s-74 62.7-88.5 152h177zM152 256c0 22.2 1.2 43.5 3.3 64h185.3c2.1-20.5 3.3-41.8 3.3-64s-1.2-43.5-3.3-64H155.3c-2.1 20.5-3.3 41.8-3.3 64zm324.7-96c-28.6-67.9-86.5-120.4-158-141.6 24.4 33.8 41.2 84.7 50 141.6h108zM177.2 18.4C105.8 39.6 47.8 92.1 19.3 160h108c8.7-56.9 25.5-107.8 49.9-141.6zM487.4 192H372.7c2.1 21 3.3 42.5 3.3 64s-1.2 43-3.3 64h114.6c5.5-20.5 8.6-41.8 8.6-64s-3.1-43.5-8.5-64zM120 256c0-21.5 1.2-43 3.3-64H8.6C3.2 212.5 0 233.8 0 256s3.2 43.5 8.6 64h114.6c-2-21-3.2-42.5-3.2-64zm39.5 96c14.5 89.3 48.7 152 88.5 152s74-62.7 88.5-152h-177zm159.3 141.6c71.4-21.2 129.4-73.7 158-141.6h-108c-8.8 56.9-25.6 107.8-50 141.6zM19.3 352c28.6 67.9 86.5 120.4 158 141.6-24.4-33.8-41.2-84.7-50-141.6h-108z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://github.com/eagletrt" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://hub.docker.com/u/eagletrt" target="_blank" rel="noopener" title="hub.docker.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path d="M349.9 236.3h-66.1v-59.4h66.1v59.4zm0-204.3h-66.1v60.7h66.1V32zm78.2 144.8H362v59.4h66.1v-59.4zm-156.3-72.1h-66.1v60.1h66.1v-60.1zm78.1 0h-66.1v60.1h66.1v-60.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1l-13.3-8.9zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm-78.1-72.1h-66.1v60.1h66.1v-60.1z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.fcfe8b6d.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.b1047164.min.js"></script>
      
        <script src="../../static/js/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
      
        <script src="../../static/js/mermaid.js"></script>
      
    
  </body>
</html>